---
import BaseLayout from '../../layouts/BaseLayout.astro';
import poles from '../../data/hg-poles.json';
---

<BaseLayout title="The Framework - Hidden Grammar">
  <div class="framework-page">
    <header class="page-header">
      <h1>The Hidden Grammar Framework</h1>
      <p class="tagline">A Complete System for Evidence-Based Art Analysis</p>
    </header>

    <div class="intro-section">
      <h2>The Foundation: Scientific Inquiry</h2>
      <p>
        <strong>Inspiration:</strong> Francis Crick (co-discoverer of DNA) & The Children's Encyclopedia.
      </p>
      <p>
        <strong>The Goal:</strong> To demystify Art. To reject "Aesthetic Vitalism" (Art is magic) and establish
        "Mechanism" (Art is a discoverable code).
      </p>
      <div class="method-box">
        <h3>The Method: Three Simultaneous Layers</h3>
        <ol>
          <li><strong>The Shoresh (Root):</strong> The conceptual DNA (Hebrew Grammar)</li>
          <li><strong>The Neural Fact:</strong> The biological mechanism (Neuroscience)</li>
          <li><strong>The Meaning:</strong> The resulting emotional function</li>
        </ol>
      </div>
    </div>

    <!-- The 4 Poles -->
    <section class="poles-section">
      <h2>The 4 Poles</h2>
      <p class="section-intro">
        Conceptual axes that <strong>modulate interpretation</strong> after Roots are established.
        Poles constrain conclusions—they do not generate them.
      </p>

      <div class="system-rules">
        <h3>System Rules</h3>
        <ul>
          {poles.systemRules.map((rule) => (
            <li>{rule}</li>
          ))}
        </ul>
      </div>

      <div class="poles-grid">
        {poles.poles.map((pole) => (
          <article class="pole-card">
            <div class="pole-header">
              <h3>{pole.name}</h3>
              <span class="pole-hebrew">{pole.hebrew}</span>
            </div>

            <div class="pole-axis">
              <span class="axis-label">↔ Opposite:</span>
              <strong>{pole.axis.oppositeName}</strong>
            </div>

            <div class="pole-content">
              <div class="pole-section">
                <h4>Governs</h4>
                <p>{pole.governs}</p>
              </div>

              <div class="pole-section">
                <h4>Function</h4>
                <p>{pole.function}</p>
              </div>

              <div class="pole-section warning">
                <h4>What This is NOT</h4>
                <ul class="not-list">
                  {pole.notThis.map((item) => (
                    <li>{item}</li>
                  ))}
                </ul>
              </div>

              <div class="pole-section">
                <h4>Activation Conditions</h4>
                <ul>
                  {pole.activationConditions.map((cond) => (
                    <li>{cond}</li>
                  ))}
                </ul>
              </div>

              <div class="pole-section">
                <h4>Failure Mode</h4>
                <p class="failure-text">{pole.failureMode}</p>
              </div>

              <div class="pole-section limits">
                <h4>Override Limits</h4>
                <div class="limits-grid">
                  <div class="may">
                    <strong>✓ May:</strong>
                    <ul>
                      {pole.overrideLimits.may.map((item) => (
                        <li>{item}</li>
                      ))}
                    </ul>
                  </div>
                  <div class="may-not">
                    <strong>✗ May Not:</strong>
                    <ul>
                      {pole.overrideLimits.mayNot.map((item) => (
                        <li>{item}</li>
                      ))}
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </article>
        ))}
      </div>

      <div class="poles-diagram">
        <h3>The Two Axes</h3>
        <div class="axes">
          <div class="axis axis-1">
            <div class="axis-line">
              <span class="pole-end">Abstraction</span>
              <span class="axis-arrow">↔</span>
              <span class="pole-end">Realism</span>
            </div>
            <p class="axis-desc">Distance from vs. closeness to depiction</p>
          </div>
          <div class="axis axis-2">
            <div class="axis-line">
              <span class="pole-end">Witness</span>
              <span class="axis-arrow">↔</span>
              <span class="pole-end">Repair</span>
            </div>
            <p class="axis-desc">Sustaining tension vs. moving toward resolution</p>
          </div>
        </div>
      </div>
    </section>

    <!-- RAP Protocol -->
    <section class="rap-section">
      <h2>Root Access Protocol (RAP)</h2>
      <p class="section-intro">
        The Evidence Gate that prevents premature meaning collapse. Roots are locked until sufficient
        perceptual evidence has been gathered.
      </p>

      <div class="rap-flow">
        <div class="rap-phase">
          <span class="phase-num">0</span>
          <h3>Declare Primary Action</h3>
          <p>Stripping / Building / Holding / Integrating</p>
        </div>

        <div class="rap-arrow">↓</div>

        <div class="rap-phase">
          <span class="phase-num">1</span>
          <h3>Hold Zone</h3>
          <p>Visual Inventory + Snag Map (No Roots, No Meaning)</p>
        </div>

        <div class="rap-arrow">↓</div>

        <div class="rap-phase">
          <span class="phase-num">2</span>
          <h3>Mechanism Mapping</h3>
          <p>Pick 3-5 Principles (Principle-First)</p>
        </div>

        <div class="rap-arrow">↓</div>

        <div class="rap-gate">
          <h3>⚠️ Evidence Gate</h3>
          <p>Requirements to pass:</p>
          <ul>
            <li>✓ Coverage: 3+ Principles mapped</li>
            <li>✓ Resistance: 1+ snag explained</li>
            <li>✓ Constraint: 1+ absence named</li>
            <li>✓ Uncertainty: 1+ ambiguity alive</li>
          </ul>
        </div>

        <div class="rap-arrow">↓</div>

        <div class="rap-phase unlocked">
          <span class="phase-num">4</span>
          <h3>Root Access</h3>
          <p>Max 2 Roots, with paid evidence</p>
        </div>

        <div class="rap-arrow">↓</div>

        <div class="rap-phase">
          <span class="phase-num">5</span>
          <h3>Meaning as Hypotheses</h3>
          <p>2 competing interpretations (not verdicts)</p>
        </div>

        <div class="rap-arrow">↓</div>

        <div class="rap-phase">
          <span class="phase-num">6</span>
          <h3>Controlled Collapse</h3>
          <p>Choose best reading if evidence supports it</p>
        </div>
      </div>

      <div class="pricing-rule">
        <h3>Pricing Rule (Anti-Spam)</h3>
        <p>
          You get <strong>3 meaning claims total</strong> in an analysis. Each meaning claim must "pay"
          with <strong>2 citations</strong> from evidence. No payment = no claim.
        </p>
      </div>
    </section>

    <!-- Quick Links -->
    <section class="quick-links">
      <h2>Explore the Framework</h2>
      <div class="links-grid">
        <a href="/hidden-grammar/roots" class="link-card">
          <h3>The 11 Roots</h3>
          <p>Analytical categories (Drivers)</p>
          <span class="arrow">→</span>
        </a>
        <a href="/hidden-grammar/principles" class="link-card">
          <h3>The 46 Principles</h3>
          <p>Perceptual mechanisms</p>
          <span class="arrow">→</span>
        </a>
        <a href="/hidden-grammar/ai-analyze" class="link-card">
          <h3>AI Analysis</h3>
          <p>Upload artwork for instant analysis</p>
          <span class="arrow">→</span>
        </a>
        <a href="/hidden-grammar" class="link-card">
          <h3>Back to Overview</h3>
          <p>Landing page</p>
          <span class="arrow">→</span>
        </a>
      </div>
    </section>
  </div>
</BaseLayout>

<style>
  .framework-page {
    max-width: 1200px;
    margin: 0 auto;
    padding: var(--space-xl) var(--space-m);
  }

  .page-header {
    text-align: center;
    margin-bottom: var(--space-2xl);
    padding-bottom: var(--space-xl);
    border-bottom: 3px solid var(--color-orange);
  }

  .page-header h1 {
    font-family: var(--font-display);
    font-size: var(--text-5xl);
    color: var(--color-orange);
    margin-bottom: var(--space-s);
  }

  .tagline {
    font-size: var(--text-xl);
    color: var(--color-gray-6);
  }

  .intro-section {
    background: var(--color-cream);
    padding: var(--space-xl);
    border-radius: 12px;
    margin-bottom: var(--space-3xl);
    line-height: 1.7;
  }

  .intro-section h2 {
    font-family: var(--font-heading);
    font-size: var(--text-2xl);
    color: var(--color-purple);
    margin-bottom: var(--space-m);
  }

  .method-box {
    background: var(--color-white);
    padding: var(--space-l);
    border-left: 4px solid var(--color-purple);
    border-radius: 6px;
    margin-top: var(--space-l);
  }

  .method-box h3 {
    font-family: var(--font-heading);
    font-size: var(--text-lg);
    color: var(--color-purple);
    margin-bottom: var(--space-m);
  }

  .method-box ol {
    padding-left: var(--space-l);
    margin: 0;
  }

  .method-box li {
    margin-bottom: var(--space-s);
  }

  .poles-section,
  .rap-section {
    margin-bottom: var(--space-3xl);
  }

  .poles-section h2,
  .rap-section h2 {
    font-family: var(--font-heading);
    font-size: var(--text-3xl);
    color: var(--color-purple);
    margin-bottom: var(--space-m);
  }

  .section-intro {
    font-size: var(--text-lg);
    color: var(--color-gray-7);
    margin-bottom: var(--space-xl);
    line-height: 1.7;
  }

  .system-rules {
    background: #fff9e6;
    padding: var(--space-l);
    border: 2px solid var(--color-yellow);
    border-radius: 8px;
    margin-bottom: var(--space-xl);
  }

  .system-rules h3 {
    font-family: var(--font-heading);
    font-size: var(--text-lg);
    color: var(--color-gray-8);
    margin-bottom: var(--space-m);
  }

  .system-rules ul {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .system-rules li {
    padding: var(--space-xs) var(--space-m);
    background: var(--color-white);
    border-left: 3px solid var(--color-orange);
    margin-bottom: var(--space-xs);
    border-radius: 4px;
  }

  .poles-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: var(--space-xl);
    margin-bottom: var(--space-2xl);
  }

  .pole-card {
    background: var(--color-white);
    border: 3px solid var(--color-purple);
    border-radius: 12px;
    padding: var(--space-xl);
  }

  .pole-header {
    display: flex;
    justify-content: space-between;
    align-items: baseline;
    margin-bottom: var(--space-m);
    padding-bottom: var(--space-m);
    border-bottom: 2px solid var(--color-gray-2);
  }

  .pole-header h3 {
    font-family: var(--font-heading);
    font-size: var(--text-2xl);
    color: var(--color-purple);
    margin: 0;
  }

  .pole-hebrew {
    font-family: monospace;
    font-size: var(--text-lg);
    color: var(--color-orange);
    font-weight: 600;
  }

  .pole-axis {
    background: var(--color-cream);
    padding: var(--space-m);
    border-radius: 6px;
    margin-bottom: var(--space-l);
    display: flex;
    align-items: center;
    gap: var(--space-s);
  }

  .axis-label {
    color: var(--color-gray-6);
    font-size: var(--text-sm);
  }

  .pole-content {
    display: flex;
    flex-direction: column;
    gap: var(--space-l);
  }

  .pole-section h4 {
    font-family: var(--font-heading);
    font-size: var(--text-lg);
    color: var(--color-gray-8);
    margin-bottom: var(--space-s);
  }

  .pole-section p {
    line-height: 1.6;
    color: var(--color-gray-7);
  }

  .pole-section ul {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .pole-section li {
    padding: var(--space-xs) 0;
    border-bottom: 1px solid var(--color-gray-2);
  }

  .pole-section li:last-child {
    border-bottom: none;
  }

  .pole-section.warning {
    background: #fff5f5;
    padding: var(--space-m);
    border-radius: 6px;
  }

  .not-list {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-xs);
  }

  .not-list li {
    padding: var(--space-xs) var(--space-m);
    background: var(--color-red);
    color: var(--color-white);
    border-radius: 20px;
    font-size: var(--text-sm);
    font-weight: 600;
    border: none;
  }

  .failure-text {
    font-style: italic;
    background: var(--color-cream);
    padding: var(--space-m);
    border-radius: 6px;
  }

  .pole-section.limits {
    background: var(--color-cream);
    padding: var(--space-m);
    border-radius: 6px;
  }

  .limits-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--space-m);
    margin-top: var(--space-s);
  }

  .limits-grid strong {
    display: block;
    margin-bottom: var(--space-xs);
  }

  .may strong {
    color: var(--color-green);
  }

  .may-not strong {
    color: var(--color-red);
  }

  .poles-diagram {
    background: var(--color-purple);
    color: var(--color-white);
    padding: var(--space-2xl);
    border-radius: 12px;
  }

  .poles-diagram h3 {
    font-family: var(--font-heading);
    font-size: var(--text-2xl);
    text-align: center;
    margin-bottom: var(--space-xl);
    color: var(--color-white);
  }

  .axes {
    display: flex;
    flex-direction: column;
    gap: var(--space-xl);
  }

  .axis {
    background: var(--color-white);
    padding: var(--space-xl);
    border-radius: 8px;
  }

  .axis-line {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-l);
    margin-bottom: var(--space-m);
  }

  .pole-end {
    font-family: var(--font-heading);
    font-size: var(--text-xl);
    color: var(--color-purple);
    font-weight: 700;
  }

  .axis-arrow {
    font-size: var(--text-3xl);
    color: var(--color-orange);
  }

  .axis-desc {
    text-align: center;
    color: var(--color-gray-6);
    margin: 0;
  }

  /* RAP Flow */
  .rap-flow {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--space-l);
    margin: var(--space-2xl) 0;
  }

  .rap-phase {
    background: var(--color-white);
    border: 3px solid var(--color-gray-4);
    border-radius: 12px;
    padding: var(--space-xl);
    width: 100%;
    max-width: 600px;
    text-align: center;
    position: relative;
  }

  .rap-phase.unlocked {
    border-color: var(--color-green);
    background: #e6f9e6;
  }

  .phase-num {
    position: absolute;
    top: -15px;
    left: 50%;
    transform: translateX(-50%);
    width: 40px;
    height: 40px;
    background: var(--color-orange);
    color: var(--color-white);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    font-size: var(--text-lg);
  }

  .rap-phase h3 {
    font-family: var(--font-heading);
    font-size: var(--text-xl);
    color: var(--color-purple);
    margin-bottom: var(--space-s);
  }

  .rap-phase p {
    color: var(--color-gray-7);
    margin: 0;
  }

  .rap-gate {
    background: #fff9e6;
    border: 3px solid var(--color-yellow);
    border-radius: 12px;
    padding: var(--space-xl);
    width: 100%;
    max-width: 600px;
  }

  .rap-gate h3 {
    font-family: var(--font-heading);
    font-size: var(--text-xl);
    color: var(--color-gray-8);
    margin-bottom: var(--space-m);
    text-align: center;
  }

  .rap-gate ul {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .rap-gate li {
    padding: var(--space-s);
    background: var(--color-white);
    border-radius: 4px;
    margin-bottom: var(--space-xs);
  }

  .rap-arrow {
    font-size: var(--text-4xl);
    color: var(--color-orange);
    font-weight: 700;
  }

  .pricing-rule {
    background: var(--color-cream);
    padding: var(--space-xl);
    border-radius: 8px;
    border-left: 4px solid var(--color-orange);
    margin-top: var(--space-2xl);
  }

  .pricing-rule h3 {
    font-family: var(--font-heading);
    font-size: var(--text-xl);
    color: var(--color-purple);
    margin-bottom: var(--space-m);
  }

  /* Quick Links */
  .quick-links {
    margin-top: var(--space-3xl);
  }

  .quick-links h2 {
    font-family: var(--font-heading);
    font-size: var(--text-3xl);
    color: var(--color-purple);
    text-align: center;
    margin-bottom: var(--space-xl);
  }

  .links-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: var(--space-l);
  }

  .link-card {
    background: var(--color-white);
    border: 2px solid var(--color-gray-3);
    border-radius: 8px;
    padding: var(--space-l);
    text-decoration: none;
    transition: all 0.2s;
    position: relative;
  }

  .link-card:hover {
    border-color: var(--color-orange);
    transform: translateY(-4px);
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.1);
  }

  .link-card h3 {
    font-family: var(--font-heading);
    font-size: var(--text-xl);
    color: var(--color-purple);
    margin: 0 0 var(--space-xs) 0;
  }

  .link-card p {
    color: var(--color-gray-6);
    margin: 0;
  }

  .link-card .arrow {
    position: absolute;
    bottom: var(--space-l);
    right: var(--space-l);
    font-size: var(--text-2xl);
    color: var(--color-orange);
  }

  @media (max-width: 768px) {
    .page-header h1 {
      font-size: var(--text-4xl);
    }

    .poles-grid {
      grid-template-columns: 1fr;
    }

    .limits-grid {
      grid-template-columns: 1fr;
    }

    .links-grid {
      grid-template-columns: 1fr;
    }
  }
</style>
